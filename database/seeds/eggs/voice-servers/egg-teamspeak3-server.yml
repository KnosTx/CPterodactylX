# DO NOT EDIT: FILE GENERATED AUTOMATICALLY BY PTERODACTYL PANEL - PTERODACTYL.IO
meta:
  version: PTDL_v2
  update_url: null
  exported_at: '2020-12-31T09:45:25-08:00'
name: 'Teamspeak3 Server'
author: support@pterodactyl.io
description: 'VoIP software designed with security in mind, featuring crystal clear voice quality, endless customization options, and scalabilty up to thousands of simultaneous users.'
features: null
images:
  - 'quay.io/parkervcp/pterodactyl-images:base_debian'
startup: './ts3server default_voice_port={{SERVER_PORT}} query_port={{SERVER_PORT}} filetransfer_ip=0.0.0.0 filetransfer_port={{FILE_TRANSFER}} license_accepted=1'
config:
  files: {  }
  startup:
    done: 'listening on 0.0.0.0:'
    userInteraction: {  }
  logs:
    custom: true
    location: logs/ts3.log
  stop: ^C
scripts:
  installation:
    script: |
      #!/bin/bash
      # TS3 Installation Script
      #
      # Server Files: /mnt/server
      apt update
      apt install -y tar curl jq bzip2
      
      if [ -z ${TS_VERSION} ] || [ ${TS_VERSION} == latest ]; then
          TS_VERSION=$(curl -sSL https://teamspeak.com/versions/server.json | jq -r '.linux.x86_64.version')
      fi
      
      cd /mnt/server
      
      echo -e "getting files from http://files.teamspeak-services.com/releases/server/${TS_VERSION}/teamspeak3-server_linux_amd64-${TS_VERSION}.tar.bz2" 
      curl -L http://files.teamspeak-services.com/releases/server/${TS_VERSION}/teamspeak3-server_linux_amd64-${TS_VERSION}.tar.bz2 | tar -xvj --strip-components=1
      
      rm teamspeak3-server_linux_amd64-${TS_VERSION}.tar.bz2
    container: 'debian:buster-slim'
    entrypoint: bash
variables:
  -
    name: 'Server Version'
    description: 'The version of Teamspeak 3 to use when running the server.'
    env_variable: TS_VERSION
    default_value: latest
    user_viewable: true
    user_editable: true
    rules: 'required|string|max:6'
  -
    name: 'File Transfer Port'
    description: 'The Teamspeak file transfer port'
    env_variable: FILE_TRANSFER
    default_value: '30033'
    user_viewable: true
    user_editable: false
    rules: 'required|integer|between:1,65535'
